# CampusFlow - Система расписания КГУ

Современное full-stack приложение для управления расписанием КГУ им. К.Э. Циолковского, состоящее из Spring Boot бэкенда и React фронтенда с современным дизайном и брендингом.

## Архитектура

- **Бэкенд**: Spring Boot + H2 Database (порт 8081)
- **Фронтенд**: React + Vite + TypeScript (порт 8080)
- **API**: REST API с CORS поддержкой

## Быстрый запуск

### Автоматический запуск (Windows)

**PowerShell (рекомендуется):**
```powershell
.\start-fullstack.ps1
```

**Command Prompt:**
```bash
start-fullstack.bat
```

### Ручной запуск

1. **Запуск бэкенда:**
```bash
cd backend
./mvnw spring-boot:run
```
*Подробные инструкции: [BACKEND_START.md](BACKEND_START.md)*

2. **Запуск фронтенда:**
```bash
cd schedule-hub-uni-main
npm install
npm run dev
```

## Доступ к приложению

- **Фронтенд**: http://localhost:8080
- **Бэкенд API**: http://localhost:8081/api/v1
- **H2 Console**: http://localhost:8081/h2-console
  - JDBC URL: `jdbc:h2:file:./data/schedule`
  - User: `sa`
  - Password: (пустой)

## API Endpoints

### Расписание
- `GET /api/v1/schedule` - Все расписания
- `GET /api/v1/schedule/subgroup/number/{number}` - Расписание по номеру группы
- `PUT /api/v1/schedule/{id}` - Обновить расписание (только для администраторов)

### Группы
- `GET /api/v1/batches` - Все группы
- `POST /api/v1/batches` - Создать группу
- `PUT /api/v1/batches/{id}` - Обновить группу
- `DELETE /api/v1/batches/{id}` - Удалить группу

### Преподаватели
- `GET /api/v1/teacher` - Все преподаватели
- `POST /api/v1/teacher` - Создать преподавателя
- `PUT /api/v1/teacher/{id}` - Обновить преподавателя
- `DELETE /api/v1/teacher/{id}` - Удалить преподавателя

### Предметы
- `GET /api/v1/subject` - Все предметы
- `POST /api/v1/subject` - Создать предмет
- `PUT /api/v1/subject/{id}` - Обновить предмет
- `DELETE /api/v1/subject/{id}` - Удалить предмет

### Факультеты
- `GET /api/v1/faculty` - Все факультеты
- `POST /api/v1/faculty/add` - Создать факультет
- `PUT /api/v1/faculty/{id}` - Обновить факультет

### Импорт данных
- `POST /api/v1/import/import-excel` - Импорт расписания из Excel файлов

## Особенности интеграции

1. **CORS настроен** для связи между фронтендом (8080) и бэкендом (8081)
2. **Прокси настроен** в Vite для перенаправления API запросов
3. **Автоматическое преобразование данных** между DTO бэкенда и типами фронтенда
4. **Поиск в реальном времени** по группам и преподавателям
5. **Обработка ошибок** и состояний загрузки

## Функциональность

- ✅ Поиск расписания по группам и преподавателям
- ✅ Отображение расписания в разных форматах:
  - **Колонки** с фиксированной шириной и горизонтальным скроллом
  - **Список** оптимизированный для мобильных устройств  
  - **Календарь** для планирования
- ✅ **Переключатель подгрупп** - простой выбор одной или нескольких подгрупп
- ✅ Система аутентификации для администраторов
- ✅ Роли пользователей (студент/администратор)
- ✅ **Полная административная панель** с интеграцией API:
  - **Полный CRUD** для групп, преподавателей и предметов
  - Создание, редактирование и удаление записей через API
  - Модальные окна с валидацией и предпросмотром
  - **Импорт Excel файлов** с реальной интеграцией парсера
  - Автообновление списков после операций
- ✅ **Полное редактирование расписания** - интегрировано с API бэкенда
- ✅ Плавная навигация между режимами
- ✅ **Полностью адаптивный дизайн**:
  - Компактный Header с иконками на мобильных
  - Адаптивные модальные окна с правильными размерами
  - Мобильные таблицы с уменьшенными отступами
  - Эмодзи-иконки в табах для экономии места

## Использование

### Для студентов
1. Откройте приложение по адресу http://localhost:8080
2. Введите номер группы или фамилию преподавателя в поисковую строку
3. Выберите нужный результат из списка
4. **Для групп**: используйте переключатель подгрупп для выбора нужных подгрупп
5. Просматривайте расписание в удобном формате:
   - **Колонки** - лучше для десктопа (с горизонтальным скроллом)
   - **Список** - рекомендуется для мобильных устройств
   - **Календарь** - для планирования по датам

### Для администраторов
1. Нажмите "Войти как админ" в правом верхнем углу
2. Войдите в систему или **зарегистрируйтесь с правами администратора**
3. При регистрации автоматически устанавливается роль `ADMIN`
4. Получите доступ к административной панели с полным CRUD:
   - **Вкладка "Группы"** - создание, редактирование, удаление групп
   - **Вкладка "Преподаватели"** - полное управление преподавателями
   - **Вкладка "Дисциплины"** - управление предметами с типами
   - **Вкладка "Загрузка"** - импорт Excel файлов с расписанием
   - **Кнопки действий**: Добавить, Редактировать, Удалить для каждой записи
   - **Кнопка "Обновить"** - перезагрузка данных из базы
5. **Редактируйте расписание**: кликайте по парам для изменения через API
   - Выбор преподавателя из базы данных с поиском
   - Выбор предмета с автоматическим определением типа занятия
   - **24-часовой формат времени** с валидацией (ЧЧ:ММ)
   - Все изменения валидируются перед сохранением
6. Изменения сохраняются в базе данных в реальном времени
7. Используйте навигацию между режимами студента и администратора

## Разработка

Для разработки рекомендуется запускать бэкенд и фронтенд отдельно в разных терминалах для лучшего контроля и отладки.

### Логи
- Бэкенд логи доступны в консоли Spring Boot
- Фронтенд логи доступны в Developer Tools браузера

### База данных
H2 база данных создается автоматически при первом запуске. Файлы БД сохраняются в `backend/data/`.

## Troubleshooting

1. **Порт занят**: Убедитесь, что порты 8080 и 8081 свободны
2. **CORS ошибки**: Проверьте, что бэкенд запущен на 8081
3. **API недоступен**: Убедитесь, что бэкенд полностью загрузился перед использованием фронтенда 